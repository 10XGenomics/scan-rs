#![cfg_attr(rustfmt, rustfmt_skip)]

use crate::betainc;
use approx::assert_abs_diff_eq;

const EPS: f64 = 1e-9;

#[test]
fn test_betainc() {
    // this corpus was generated using cargo-fuzzcheck, in an effort to exercise many codepaths
    assert_abs_diff_eq!(betainc(1.843870169482912, 8307763903986080.0, 1.4115145329400399e-13), 0.9999999999999999, epsilon = EPS);
    assert_abs_diff_eq!(betainc(1.557_376_483_595_712e306, 12.835526832822119, 8.890580925096688e-97), 0.0, epsilon = EPS);
    assert_abs_diff_eq!(betainc(5.462446616333078e-263, 8307763903986082.0, 1.4115145329400399e-13), 0.9999999999999999, epsilon = EPS);
    assert_abs_diff_eq!(betainc(158.8013125166455, 1.843870169482912, 0.6201650381961528), 3.831178721758123e-32, epsilon = EPS);
    assert_abs_diff_eq!(betainc(1.293644352290662e-154, 8307763903986081.0, 5.675886340712604e-14), 0.9999999999999999, epsilon = EPS);
    assert_abs_diff_eq!(betainc(472.10888886448083, 472.10888886448083, 8.890580925096688e-97), 0.0, epsilon = EPS);
    assert_abs_diff_eq!(betainc(5.462446616333078e-263, 1.119_594_371_920_983_4e16, 0.30983455999225507), 0.9999999999999999, epsilon = EPS);
    assert_abs_diff_eq!(betainc(5.462446616333078e-263, 1.119_594_371_920_983_4e16, 0.1551595169687376), 0.9999999999999999, epsilon = EPS);
    assert_abs_diff_eq!(betainc(2.2586453105439303e-12, 1.843870169482912, 0.8682156981488498), 0.999999999999968, epsilon = EPS);
    assert_abs_diff_eq!(betainc(1.8438701694829118, 7.382743961174512, 9.612141155540285e-232), 0.0, epsilon = EPS);
    assert_abs_diff_eq!(betainc(2.7031137979285784, 1.293644352290662e-154, 0.6201650381961528), 2.5244080588411138e-155, epsilon = EPS);
    assert_abs_diff_eq!(betainc(472.10888886448083, 1.716_429_310_321_900_3e231, 9.612141155540285e-232), 0.0, epsilon = EPS);
    assert_abs_diff_eq!(betainc(5.462446616333078e-263, 8307763903986080.0, 1.4115145329400399e-13), 0.9999999999999999, epsilon = EPS);
    assert_abs_diff_eq!(betainc(30940128.140622616, 7554.242246626032, 8.890580925096688e-97), 0.0, epsilon = EPS);
    assert_abs_diff_eq!(betainc(1173.5210872604746, 8307763903986081.0, 1.4115145329400399e-13), 0.7005624599976614, epsilon = EPS);
    assert_abs_diff_eq!(betainc(2.2586453105439303e-12, 1.293644352290662e-154, 0.8682156981488498), 5.72752324704153e-143, epsilon = EPS);
    assert_abs_diff_eq!(betainc(1.8438701694829118, 472.10888886448083, 0.6201650381961528), 0.9999999999999999, epsilon = EPS);
    assert!(betainc(1.350_065_702_451_796_3e93, 1.008_629_642_914_941_1e176, 8.890580925096688e-97).is_nan());
    assert_abs_diff_eq!(betainc(1.843870169482912, 1.008_629_642_914_941_1e176, 1.1259327748053284e-182), 6.281279352491345e-12, epsilon = EPS);
    assert_abs_diff_eq!(betainc(5.462446616333078e-263, 8307763903986081.0, 0.009700807742049945), 0.9999999999999999, epsilon = EPS);
    assert_abs_diff_eq!(betainc(1.557_376_483_595_712e306, 6.413979178980679, 8.890580925096688e-97), 0.0, epsilon = EPS);
    assert_abs_diff_eq!(betainc(29.515106461936398, 29.515106461936398, 8.890580925096688e-97), 0.0, epsilon = EPS);
    assert_abs_diff_eq!(betainc(472.10888886448083, 1.008_629_642_914_941_1e176, 1.8885004707533666e-175), 0.0, epsilon = EPS);
    assert!(betainc(1.844_618_167_351_181_3e19, 1.844_618_167_351_181_3e19, 3.170_079_348_685_089_3e18).is_nan());
    assert_abs_diff_eq!(betainc(1.843870169482912, 7.202_093_901_583_882e95, 8.890580925096688e-97), 0.16885877899853108, epsilon = EPS);
    assert_abs_diff_eq!(betainc(1.293644352290662e-154, 1.293644352290662e-154, 0.9997560977935223), 0.5, epsilon = EPS);
    assert!(betainc(8.245_880_056_648_869e18, 1.906_534_986_194_192_6e18, 1.644_908_727_520_277_3e19).is_nan());
    assert_abs_diff_eq!(betainc(43.23065543544351, 59.105897672459605, 8.890580925096688e-97), 0.0, epsilon = EPS);
    assert_abs_diff_eq!(betainc(3.790_833_221_445_655e-5, 3.790_833_221_445_655e-5, 2.2586453105439303e-12), 0.49949197967270687, epsilon = EPS);
    assert_abs_diff_eq!(betainc(1.8438701694829118, 1.843870169482912, 9.612141155540285e-232), 0.0, epsilon = EPS);
    assert_abs_diff_eq!(betainc(5.78435244971566e-10, 5.78435244971566e-10, 0.6201650381961528), 0.5000000001417882, epsilon = EPS);
    assert_abs_diff_eq!(betainc(2.7031137979285784, 1.843870169482912, 0.6201650381961528), 0.5178524319282776, epsilon = EPS);
    assert_abs_diff_eq!(betainc(29.515106461936398, 1.843870169482912, 0.6201650381961528), 6.562_041_187_778_983e-6, epsilon = EPS);
    assert_abs_diff_eq!(betainc(472.10888886448083, 1.843870169482912, 1.8885004707533666e-175), 0.0, epsilon = EPS);
    assert!(betainc(9.187_833_631_685_313e18, 1.844_618_167_351_181_3e19, 3.170_079_348_685_089_3e18).is_nan());
    assert_abs_diff_eq!(betainc(1.8438701694829118, 1.843870169482912, 0.6201650381961528), 0.6693780700158802, epsilon = EPS);
    assert_abs_diff_eq!(betainc(1.8438701694829118, 1.441_478_055_187_722_2e96, 8.890580925096688e-97), 1.4992911733594614, epsilon = EPS);
    assert_abs_diff_eq!(betainc(1.843870169482912, 129817401262056.5, 2.2586453105439303e-12), 0.9999999999999999, epsilon = EPS);
    assert_abs_diff_eq!(betainc(7.382743961174512, 7.382743961174512, 9.612141155540285e-232), 0.0, epsilon = EPS);
    assert_abs_diff_eq!(betainc(1.843870169482912, 7.032_658_227_739_396e92, 8.890580925096688e-97), 7.104_962_808_913_047e-7, epsilon = EPS);
    assert_abs_diff_eq!(betainc(472.10888886448083, 8307763903986080.0, 5.675886340712604e-14), 0.6175537764385253, epsilon = EPS);
    assert_abs_diff_eq!(betainc(43.23065543544351, 118.08777001498584, 8.890580925096688e-97), 0.0, epsilon = EPS);
    assert_abs_diff_eq!(betainc(5.78435244971566e-10, 1.293644352290662e-154, 0.6201650381961528), 2.23645492542748e-145, epsilon = EPS);
    assert_abs_diff_eq!(betainc(19.827458639998063, 1.008_629_642_914_941_1e176, 1.8885004707533666e-175), 86004906.16222902, epsilon = EPS);
    assert_abs_diff_eq!(betainc(1.8438701694829118, 3.6952935492119785, 9.612141155540285e-232), 0.0, epsilon = EPS);
    assert_abs_diff_eq!(betainc(1.843870169482912, 7554.242246626032, 8.890580925096688e-97), 6.37718654010166e-171, epsilon = EPS);
    assert_abs_diff_eq!(betainc(5.462446616333078e-263, 8307763903986081.0, 1.4115145329400399e-13), 0.9999999999999999, epsilon = EPS);
    assert_abs_diff_eq!(betainc(1.8438701694829118, 1.293644352290662e-154, 0.8682156981488498), 1.6097411975021833e-154, epsilon = EPS);
    assert_abs_diff_eq!(betainc(5.462446616333078e-263, 1.119_594_371_920_983_4e16, 3.790_833_221_445_655e-5), 0.9999999999999999, epsilon = EPS);
    assert_abs_diff_eq!(betainc(1.293644352290662e-154, 8307763903986079.0, 5.675886340712604e-14), 0.9999999999999999, epsilon = EPS);
    assert_abs_diff_eq!(betainc(1.843870169482912, 7.202_093_901_583_882e95, 1.0167298691645859e-97), 0.004420231391426075, epsilon = EPS);
    assert!(betainc(1.557_376_483_595_712e306, 1.557_376_483_595_712e306, 8.890580925096688e-97).is_nan());
    assert!(betainc(4.619_998_249_165_517e18, 1.844_618_167_351_181_3e19, 1.150_635_037_456_704e18).is_nan());
    assert!(betainc(1.843870169482912, 1.008_629_642_914_941_1e176, 8.890580925096688e-97).is_nan());
    assert_abs_diff_eq!(betainc(1.8438701694829118, 2.147_500_404_792_697_2e154, 0.9981004925335297), 0.9999999999999999, epsilon = EPS);
    assert_abs_diff_eq!(betainc(5.462446616333078e-263, 1.119_594_371_920_983_4e16, 1.2091681961632123e-238), 1.0, epsilon = EPS);
    assert_abs_diff_eq!(betainc(1.8438701694829118, 0.0006062408756806186, 0.9997560977935223), 0.004491335314258271, epsilon = EPS);
    assert_abs_diff_eq!(betainc(5.462446616333078e-263, 8307763903986080.0, 0.009700807742049945), 0.9999999999999999, epsilon = EPS);
    assert_abs_diff_eq!(betainc(5.398338681547479, 1.716_429_310_321_900_3e231, 9.612141155540285e-232), 0.08259212080351443, epsilon = EPS);
    assert!(betainc(8.396_922_709_076_336e86, 4.880_798_850_784_677e99, 2.9404717526316766e-136) == std::f64::INFINITY);
    assert!(betainc(4.719_070_637_635_665e18, 1.844_618_167_351_181_3e19, 3.170_079_348_685_089_3e18).is_nan());
    assert_abs_diff_eq!(betainc(1.843870169482912, 3.790_833_221_445_655e-5, 2.2586453105439303e-12), 6.902824997525354e-27, epsilon = EPS);
    assert_abs_diff_eq!(betainc(9.909_447_322_367_923e172, 1.008_629_642_914_941_1e176, 8.890580925096688e-97), 0.0, epsilon = EPS);
    assert_abs_diff_eq!(betainc(7.382743961174512, 1.716_429_310_321_900_3e231, 9.612141155540285e-232), 0.0045328433283154815, epsilon = EPS);
    assert_abs_diff_eq!(betainc(1.293644352290662e-154, 1.843870169482912, 0.9997560977935223), 0.9999999999999999, epsilon = EPS);
    assert!(betainc(1.844_618_167_351_181_3e19, 4.638_010_105_015_565e18, 1.150_635_037_456_704e18).is_nan());
    assert_abs_diff_eq!(betainc(1.8438701694829118, 118.08777001498584, 9.612141155540285e-232), 0.0, epsilon = EPS);
    assert_abs_diff_eq!(betainc(1.293644352290662e-154, 0.0006062408756806186, 0.9997560977935223), 0.9999999999999999, epsilon = EPS);
    assert_abs_diff_eq!(betainc(1173.5210872604746, 8307763903986080.0, 1.4115145329400399e-13), 0.7005624599976555, epsilon = EPS);
    assert_abs_diff_eq!(betainc(472.10888886448083, 8307763903986080.0, 2.2586453105439303e-12), 0.9999999999999999, epsilon = EPS);
    assert_abs_diff_eq!(betainc(1.557_376_483_595_712e306, 4.429573899359102, 8.890580925096688e-97), 0.0, epsilon = EPS);
    assert_abs_diff_eq!(betainc(2.7031137979285784, 3.6952935492119785, 0.6201650381961528), 0.8447222121369603, epsilon = EPS);
    assert!(betainc(1.557_376_483_595_712e306, 1.794_278_403_330_222_6e308, 8.890580925096688e-97).is_nan());
    assert_abs_diff_eq!(betainc(1.293644352290662e-154, 1.716_429_310_321_900_3e231, 0.6201650381961528), 0.9999999999999999, epsilon = EPS);
    assert_abs_diff_eq!(betainc(1173.5210872604746, 495074819.87488365, 1.4115145329400399e-13), 0.0, epsilon = EPS);
}
