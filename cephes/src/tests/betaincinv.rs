#![cfg_attr(rustfmt, rustfmt_skip)]

use crate::betaincinv;
use approx::assert_abs_diff_eq;

const EPS: f64 = 1e-9;

#[test]
fn test_betaincinv() {
    // this corpus was generated using cargo-fuzzcheck, in an effort to exercise many codepaths
    assert_abs_diff_eq!(betaincinv(1.1055776540280364, 1.8225012474426643e-39, 1.103812214615622e-308), 3.3941487814688405e-244, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(29.515106461936398, 2.871897916555828e-69, 3.3359571778831774e-68), 1.1102230246251565e-16, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.560_609_709_012_784e77, 126766416991.9751, 3.3359571778831774e-68), 1.1102230246251565e-16, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.560_609_709_012_785e77, 1.560_609_709_012_785e77, 0.6201650381961528), 0.49999996067664865, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.051_711_911_892_537_5e19, 1.527_417_993_379_063_4e19, 2.014_623_518_362_698_2e18), 1.0, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.8438701694829118, 1.146_465_599_489_637_4e16, 6.5507427730541396e-15), 2.3920114592836127e-24, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(29.515106461936398, 2.2586453105439303e-12, 2.2586453105439303e-12), 0.9908567688407375, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.1055776540280364, 1.843870169482912, 0.009700807742049945), 0.008366427396446571, epsilon = EPS);
    assert!(betaincinv(1.919_729_973_583_725_8e99, 9.128_698_147_761_993e79, 6.639229209733423e-40).is_nan());
    assert_abs_diff_eq!(betaincinv(1.560_609_709_012_784e77, 1.560_609_709_012_785e77, 3.3359571778831774e-68), 0.5000000000582075, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(5.936_612_067_299_136e60, 9.6855154122371e+75, 1.1303884765626168e-48), 6.12937134950873e-16, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(495074819.8748837, 495074819.87488365, 1.069496360907123e-77), 0.49970410255145997, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(29.515106461936398, 1.4115145329400399e-13, 1.4115145329400399e-13), 0.9921219444238881, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(29.515106461936398, 1.328_868_384_980_234_2e17, 0.21717218195691185), 2.77555756156284e-16, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(29.515106461936398, 1.843870169482912, 3.790_833_221_445_655e-5), 0.6600453045793161, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(2.126_330_160_435_716e18, 1.843870169482912, 2.2586453105439303e-12), 0.9999999999988707, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.238392180611425, 1.146_465_599_489_637_2e16, 0.6201650381961528), 2.7755575615628593e-16, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.8438701694829118, 1.593_313_943_382_423_8e16, 0.6201650381961528), 1.1102230246251565e-16, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.414_977_690_855_268_1e54, 3.140_479_686_646_865_6e38, 2.2586453105439303e-12), 0.9999999999999998, epsilon = EPS);
    assert!(betaincinv(8.43211231879831e+46, 3.140_479_686_646_866e38, 2.2586453105439303e-12).is_nan());
    assert_abs_diff_eq!(betaincinv(1.8438701694829118, 2.147_500_404_792_697_2e154, 5.1258966065909503e-290), 8.046366352564e-312, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.8438701694829118, 3.790_833_221_445_655e-5, 1.3762666116484325e-281), 1.660742705553435e-150, epsilon = EPS);
    assert!(betaincinv(1.238392180611425, 2.147_500_404_792_697_2e154, 0.6201650381961528).is_nan());
    assert_abs_diff_eq!(betaincinv(6.915_735_149_216_515e18, 1.844_618_167_351_181_3e19, 3.597_469_728_308_374e18), 1.0, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.843870169482912, 472.10888886448083, 1.8892879515294831e-270), 1.4954290537781022e-149, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(495074819.8748836, 495074819.8748836, 1.293644352290662e-154), 0.4995795075681208, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.8438701694829123, 2.147_500_404_792_697_2e154, 1.293644352290662e-154), 2.1837904478047298e-238, epsilon = EPS);
    assert!(betaincinv(1.560_609_709_012_784e77, 1.560_609_709_012_785_8e77, 3.3359571778831774e-68).is_nan());
    assert_abs_diff_eq!(betaincinv(118.08777001498584, 29.515106461936398, 2.2586453105439303e-12), 0.5277748649875931, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(29.515106461936398, 0.8682156981488498, 0.03877366657507557), 0.9037501515093473, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(495074819.8748836, 495074819.87488365, 1.293644352290662e-154), 0.4995795075681585, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(9.945_937_739_501_685e18, 9.607_372_904_940_485e18, 3.070_413_366_366_549e18), 1.0, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.560_609_709_012_785e77, 2.871897916555828e-69, 3.790_833_221_445_655e-5), 0.9999999999999999, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.843870169482912, 3.757797006295928, 0.1551595169687376), 0.13550058479390192, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.387_003_323_458_401e19, 3.45533453712894e+18, 3.597_469_728_308_374e18), 1.0, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.593_313_943_382_424_2e16, 1.843870169482912, 0.1551595169687376), 0.9999999999999999, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.919_729_973_583_726_3e99, 7.202_093_901_583_882e95, 6.639229209733423e-40), 1.1102230246251565e-16, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.843870169482912, 141.80105311397176, 3.790_833_221_445_655e-5), 3.806_409_084_701_710_4e-5, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(2.7031137979285784, 1.843870169482912, 0.8682156981488498), 0.8390380962815362, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(8307763903986077.0, 3.757797006295928, 0.1551595169687376), 0.9999999999999999, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.328_868_384_980_234_2e17, 30940128.140622616, 7.843508242931188e-14), 0.9999999997668574, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.293644352290662e-154, 1.069496360907123e-77, 3.3359571778831774e-68), 0.0, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.378_374_876_505_632_4e19, 5.257_280_019_589_733e18, 4.867_753_898_274_522e18), 1.0, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.406_116_865_761_869_2e19, 1.39601057769145e+19, 2.921_844_108_231_454_7e18), 1.0, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.414_977_690_855_268_1e54, 3.140_479_686_646_866e38, 2.2586453105439303e-12), 0.9999999999999998, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.498_504_217_192_299_7e19, 5.761_670_135_068_222e18, 4.603_761_169_615_133e18), 1.0, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(118.08777001498584, 29.515106461936398, 1.293644352290662e-154), 0.027750488559629666, epsilon = EPS);
    assert!(betaincinv(8307763903986077.0, 2.147_500_404_792_697_2e154, 0.8682156981488498).is_nan());
    assert_abs_diff_eq!(betaincinv(118.08777001498584, 1.069496360907123e-77, 1.069496360907123e-77), 1.1102230246251565e-16, epsilon = EPS);
    assert!(betaincinv(1.794_278_403_330_222_6e308, 1.557_376_483_595_712e306, 1.4115145329400399e-13).is_nan());
    assert_abs_diff_eq!(betaincinv(1.560_609_709_012_784e77, 8115466664956.109, 3.3359571778831774e-68), 1.1102230246251565e-16, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(7.382743961174512, 1.0694963609071231e-77, 3.3359571778831774e-68), 0.9999999999999999, epsilon = EPS);
    assert!(betaincinv(1.843870169482912, 1.560_609_709_012_785e77, 2.2586453105439303e-12).is_nan());
    assert_abs_diff_eq!(betaincinv(1.843870169482912, 1.146_465_599_489_637_2e16, 0.6201650381961528), 2.775365931863208e-16, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.293644352290662e-154, 1.350_288_306_363_675e288, 0.8682156981488498), 0.0, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.8438701694829118, 0.6201650381961528, 2.8480918253870994e-306), 2.800267556609848e-166, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(5.936_612_067_299_137e60, 9.685_515_412_237_105e75, 1.1303884765626168e-48), 6.129371349508728e-16, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(472.10888886448083, 2.2586453105439303e-12, 2.2586453105439303e-12), 0.9996149608619469, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(495074819.8748836, 495074819.87488365, 1.6375448208376752e-193), 0.49952884757649674, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(2.147_500_404_792_697_2e154, 1.146_465_599_489_637_4e16, 0.6201650381961528), 0.9999999999999999, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.613_875_534_020_281_1e19, 4.719_070_637_635_665e18, 4.432_630_568_634_130_4e18), 1.0, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(495074819.87488365, 495074819.8748837, 1.069496360907123e-77), 0.4997041025515105, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(8307763903986078.0, 3.757797006295928, 0.009700807742049945), 0.9999999999999988, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(7554.242246626032, 9.612141155540285e-232, 3.3359571778831774e-68), 1.1102230246251565e-16, epsilon = EPS);
    assert!(betaincinv(30940128.140622616, 3.140_479_686_646_866e38, 2.2586453105439303e-12).is_nan());
    assert_abs_diff_eq!(betaincinv(2.126_330_160_435_716e18, 30940128.140622616, 2.2586453105439303e-12), 0.9999999999854424, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.843870169482912, 4.059_991_715_566_899e176, 1.8892879515294831e-270), 1.5e-323, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(29.515106461936398, 5.78435244971566e-10, 7.213898002921023e-11), 0.9544226387578321, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.593_313_943_382_423_6e16, 1.843870169482912, 0.1551595169687376), 0.9999999999999998, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.8438701694829118, 1.843870169482912, 0.6201650381961528), 0.5845428670306907, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.8438701694829118, 2.147_500_404_792_697_2e154, 2.8480918253870994e-306), 1.229e-320, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(9.612141155540285e-232, 2.147_500_404_792_697_2e154, 0.6201650381961528), 0.0, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(7554.242246626032, 2.871897916555828e-69, 3.3359571778831774e-68), 0.9999999999999999, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(495074819.8748836, 495074819.8748837, 1.069496360907123e-77), 0.4997041025514646, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(8307763903986077.0, 29.515106461936398, 0.8682156981488498), 0.9999999999999971, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(8307763903986078.0, 3.757797006295928, 0.1551595169687376), 0.9999999999999992, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.8438701694829118, 1.843870169482912, 0.4338598899686036), 0.4537299361608404, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(29.515106461936398, 1.843870169482912, 0.21717218195691185), 0.9143436925675853, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.328_868_384_980_234_4e17, 30940128.140622616, 7.843508242931188e-14), 0.49999999988343014, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.843870169482912, 29.515106461936398, 3.049915727802279e-202), 2.316264974537631e-111, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1863414038.4613109, 495074819.87488365, 1.293644352290662e-154), 0.7898661564654132, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.293644352290662e-154, 7554.242246626032, 3.3359571778831774e-68), 0.0, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.560_609_709_012_785e77, 472.10888886448083, 3.3359571778831774e-68), 1.1102230246251565e-16, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.560_609_709_012_785e77, 495074819.87488365, 1.293644352290662e-154), 1.1102230246251565e-16, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(118.08777001498584, 29.515106461936398, 3.049915727802279e-202), 0.010918499830068656, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(29.515106461936398, 1.802719539586597e-11, 2.2586453105439303e-12), 0.9544956573252943, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.1055776540280364, 1.843870169482912, 1.103812214615622e-308), 1.561077582270574e-279, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(4.610_982_872_180_849_7e18, 1.387_003_323_458_401e19, 3.597_469_728_308_374e18), 1.0, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(5.269_721_732_825_172e45, 3.140_479_686_646_866e38, 5.78435244971566e-10), 0.9999999404052119, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.560_609_709_012_785e77, 9.685_515_412_237_096e75, 2.2586453105439303e-12), 0.9415642791128821, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(7.382743961174512, 2.147_500_404_792_697_2e154, 3.3359571778831774e-68), 1.190485603007226e-163, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.328_868_384_980_234_2e17, 30940128.14062263, 5.78435244971566e-10), 0.9999999997669652, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(2.304_647_274_241_557e18, 4.610_982_872_180_849_7e18, 1.844_618_167_351_181_3e19), 1.0, epsilon = EPS);
    assert!(betaincinv(1.557_376_483_595_712e306, 1.557_376_483_595_712e306, 3.3359571778831774e-68).is_nan());
    assert_abs_diff_eq!(betaincinv(1.2383921806114258, 1.146_465_599_489_637_2e16, 1.293644352290662e-154), 5.2193091062838475e-141, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(495074819.87488365, 495074819.87488365, 1.293644352290662e-154), 0.49957950756816794, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(4.610_982_872_180_849_7e18, 1.844_618_167_351_181_3e19, 3.597_469_728_308_374e18), 1.0, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.8438701694829118, 0.6201650381961528, 5.1258966065909503e-290), 1.8323701296580628e-157, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.843870169482912, 1.293644352290662e-154, 0.009700807742049945), 0.9999999999999999, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(2.126_330_160_435_715_8e18, 30940128.140622616, 9.250_501_643_075_845e-9), 0.9999999999854343, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.844_119_420_947_385_8e19, 1.842_886_629_699_421_8e19, 3.597_469_728_308_374e18), 1.0, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.843870169482912, 1.146_465_599_489_637_4e16, 1.293644352290662e-154), 4.0905631499952815e-100, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(472.10888886448083, 5.78435244971566e-10, 4.293094783748761e-10), 0.9992019294648512, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(5.625_150_835_342_006e18, 1.294_554_147_793_810_6e19, 1.091_122_531_219_179_7e19), 1.0, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.8438701694829118, 1.593_313_943_382_424e16, 4.727_700_195_194_322e-6), 2.7755575615628795e-16, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.843870169482912, 1.069496360907123e-77, 3.3359571778831774e-68), 1.1102230246251565e-16, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.844_618_167_351_181_3e19, 1.844_618_167_351_181_3e19, 3.597_469_728_308_374e18), 1.0, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.238392180611425, 1.146_465_599_489_637_4e16, 0.6201650381961528), 1.665334536937714e-16, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.560_609_709_012_785e77, 7554.242246626032, 3.3359571778831774e-68), 1.1102230246251565e-16, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(4.610_982_872_180_849_7e18, 4.603_761_169_615_133e18, 1.844_618_167_351_181_3e19), 1.0, epsilon = EPS);
    assert!(betaincinv(1.328_868_384_980_234_2e17, 2.284_300_790_514_626e27, 7.843508242931188e-14).is_nan());
    assert_abs_diff_eq!(betaincinv(29.515106461936398, 0.8682156981488498, 5.969135593168421e-136), 2.669_408_722_766_529_2e-5, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.560_609_709_012_784e77, 129817401262056.5, 3.3359571778831774e-68), 1.1102230246251565e-16, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.414_977_690_855_268_3e54, 8.43211231879831e+46, 2.2586453105439303e-12), 0.9999999404081642, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(472.10888886448083, 5.78435244971566e-10, 2.2586453105439303e-12), 0.9916100559863559, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(495074819.87488365, 1.843870169482912, 5.969135593168421e-136), 1.1102230246251565e-16, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(126766416991.9751, 3.757797006295928, 0.1551595169687376), 0.9999999999554379, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(29.515106461936398, 29.515106461936398, 0.21717218195691185), 0.4490408927284241, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(2.126_330_160_435_716e18, 30940128.140622616, 9.250_501_643_075_845e-9), 0.9999999999854228, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(7.382743961174512, 3.140_479_686_646_866e38, 3.3359571778831774e-68), 8.140512592133232e-48, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(8307763903986080.0, 1.843870169482912, 0.1551595169687376), 0.9999999999999996, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.843870169482912, 1.146_465_599_489_637_4e16, 0.6201650381961528), 1.3103501446623299e-16, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.8438701694829118, 1.843870169482912, 2.8480918253870994e-306), 1.1887531837625024e-166, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(29.515106461936398, 29.515106461936398, 3.790_833_221_445_655e-5), 0.257769365073811, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.8438701694829118, 1.843870169482912, 1.3762666116484325e-281), 2.898891472133658e-153, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.843870169482912, 29.515106461936398, 0.009700807742049945), 0.0037927087122608823, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(2.7031137979285784, 1.843870169482912, 0.1551595169687376), 0.361626790428575, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(4.638_010_105_015_565e18, 4.629_000_981_586_115e18, 1.844_618_167_351_181_3e19), 1.0, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.843870169482912, 141.80105311397176, 1.8892879515294831e-270), 4.968532223329709e-149, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.841_085_382_267_163_4e19, 1.844_618_167_351_181_3e19, 3.597_469_728_308_374e18), 1.0, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(7.382743961174512, 2.147_500_404_792_697_2e154, 1.4115145329400399e-13), 3.007932711083421e-156, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(118.08777001498584, 3.790_833_221_445_655e-5, 8.411214268965339e-21), 1.1102230246251565e-16, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.1055776540280364, 8.507_713_209_110_135e18, 1.103812214615622e-308), 3.4714090760436908e-298, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(0.8682156981488498, 6.086_149_278_929_081e303, 1.4115145329400399e-13), 2.4538e-319, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(29.515106461936398, 1.843870169482912, 2.955_831_276_601_876e-7), 0.5560335724776291, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.560_609_709_012_785e77, 9.685_515_412_237_096e75, 1.1303884765626168e-48), 1.1102230246251565e-16, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(8307763903986080.0, 1.146_465_599_489_637_4e16, 0.6201650381961528), 0.4201693699329976, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(5.936_612_067_299_135_4e60, 9.685_515_412_237_104e75, 1.1303884765626168e-48), 6.129371349508728e-16, epsilon = EPS);
    assert!(betaincinv(2.126_330_160_435_716e18, 1.293644352290662e-154, 9.250_501_643_075_845e-9).is_nan());
    assert_abs_diff_eq!(betaincinv(1.238392180611425, 1.293644352290662e-154, 0.6201650381961528), 0.9999999999999999, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.77951627367386e-307, 1.146_465_599_489_637_2e16, 0.6201650381961528), 0.0, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.406_116_865_761_869_2e19, 1.39601057769145e+19, 2.921_844_108_231_454_7e18), 1.0, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(495074819.8748837, 8.507_713_209_110_136e18, 1.293644352290662e-154), 5.812028856126831e-11, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1863414038.4613106, 495074819.87488365, 1.293644352290662e-154), 0.7898661564677996, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(495074819.8748837, 8.507_713_209_110_136e18, 2.7299346397841877e-89), 5.8169782672243804e-11, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(5.010_658_135_455_066e17, 1.318_688_513_038_526e19, 1.34873998913845e+18), 1.0, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(118.08777001498584, 9.612141155540285e-232, 1.293644352290662e-154), 0.9999999999999999, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(495074819.8748837, 8.507_713_209_110_136e18, 2.203480944146181e-116), 5.812595439091385e-11, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(495074819.87488365, 1.843870169482912, 1.293644352290662e-154), 1.1102230246251565e-16, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.843870169482912, 1.069496360907123e-77, 1.293644352290662e-154), 2.68498478242408e-42, epsilon = EPS);
    assert!(betaincinv(2.159_084_611_290_387e49, 3.140_479_686_646_866e38, 2.813_522_597_477_588e-5).is_nan());
    assert_abs_diff_eq!(betaincinv(3.9005400250781565e-173, 1.293644352290662e-154, 1.547616606103657e-175), 0.0, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(29.515106461936398, 9.027697745495375e-12, 2.2586453105439303e-12), 0.9686483404722067, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(29.515106461936398, 5.78435244971566e-10, 2.2586453105439303e-12), 0.8720178078026892, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.613_875_534_020_281_1e19, 4.647_013_043_597_737e18, 3.597_469_728_308_374e18), 1.0, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(472.10888886448083, 1.8225012474426643e-39, 3.3359571778831774e-68), 1.1102230246251565e-16, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(495074819.87488365, 3.4734555141206806e-146, 1.293644352290662e-154), 1.1102230246251565e-16, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(5.936_612_067_299_137e60, 9.685_515_412_237_104e75, 1.1303884765626168e-48), 6.129371349508729e-16, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(118.08777001498584, 29.515106461936398, 8.411214268965339e-21), 0.4279166852121233, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.593_313_943_382_423_8e16, 1.843870169482912, 0.1551595169687376), 0.9999999999999999, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.8438701694829118, 1.843870169482912, 6.5507427730541396e-15), 1.234_517_600_939_558_4e-8, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(29.515106461936398, 0.8682156981488498, 0.24964338055308183), 0.9599415536491135, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.843870169482912, 472.10888886448083, 0.8682156981488498), 0.006991285138664538, epsilon = EPS);
    assert!(betaincinv(7.0313387677996e-276, 2.812_583_680_246_972e157, 6.462633834167962e-100).is_nan());
    assert!(betaincinv(2.659_057_677_191_648_5e115, 2.147_500_404_792_697_2e154, 1.293644352290662e-154).is_nan());
    assert_abs_diff_eq!(betaincinv(1.593_313_943_382_423_4e16, 1.843870169482912, 0.1551595169687376), 0.9999999999999999, epsilon = EPS);
    assert!(betaincinv(1.8438701694829118, 1.560_609_709_012_785e77, 0.6201650381961528).is_nan());
    assert_abs_diff_eq!(betaincinv(1.293644352290662e-154, 472.10888886448083, 0.8682156981488498), 0.0, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(495074819.87488365, 7.382743961174512, 1.293644352290662e-154), 1.1102230246251565e-16, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(4.618_907_516_987_492e18, 1.39601057769145e+19, 3.597_469_728_308_374e18), 1.0, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(3.790_833_221_445_655e-5, 1.0694963609071231e-77, 3.3359571778831774e-68), 0.9999999999999999, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(4.619_998_249_165_517e18, 1.383_400_306_316_712_3e19, 3.597_469_728_308_374e18), 1.0, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(118.08777001498584, 3.790_833_221_445_655e-5, 2.2586453105439303e-12), 0.888238631165187, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(4.619_998_249_165_517e18, 5.182_948_752_363_615e18, 1.844_618_167_351_181_3e19), 1.0, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(9.187_833_631_685_313e18, 1.842_886_629_699_421_8e19, 3.597_469_728_308_374e18), 1.0, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.238392180611425, 1.146_465_599_489_637e16, 0.6201650381961528), 1.6655417884366925e-16, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.238392180611425, 1.146_465_599_489_636_8e16, 0.6201650381961528), 2.7755575615629037e-16, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(8.507_713_209_110_135e18, 1.328_868_384_980_234_2e17, 0.21717218195691185), 0.9846206469403835, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.687_530_693_864_592_4e19, 1.751_970_872_653_392_5e19, 1.303_141_573_335_225_9e18), 1.0, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(118.08777001498584, 0.009700807742049945, 2.2586453105439303e-12), 0.8492237453275879, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(1.8438701694829118, 1.593_313_943_382_423_8e16, 4.727_700_195_194_322e-6), 1.097255638652843e-19, epsilon = EPS);
    assert_abs_diff_eq!(betaincinv(0.8682156981488498, 2.964_941_708_551_698_6e300, 1.4115145329400399e-13), 5.0369017e-316, epsilon = EPS);
}
